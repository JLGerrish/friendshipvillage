!function(e){e.fn.columnize=function(t){var n={width:400,columns:!1,buildOnce:!1,overflow:!1,doneFunc:function(){},target:!1,ignoreImageLoading:!0,columnFloat:"left",lastNeverTallest:!1,accuracy:!1,manualBreaks:!1,cssClassPrefix:""};return"string"==typeof(t=e.extend(n,t)).width&&(t.width=parseInt(t.width),isNaN(t.width)&&(t.width=n.width)),this.each(function(){function o(e,t){var n=t?".":"";return g.length?n+g+"-"+e:n+e}function i(n,i,l,a){for(;(u||l.height()<a)&&i[0].childNodes.length;){var r=i[0].childNodes[0];if(e(r).find(o("columnbreak",!0)).length)return;if(e(r).hasClass(o("columnbreak")))return;n.append(r)}if(0!=n[0].childNodes.length){var d=n[0].childNodes,s=d[d.length-1];n[0].removeChild(s);var c=e(s);if(3==c[0].nodeType){var h=c[0].nodeValue,f=t.width/18;t.accuracy&&(f=t.accuracy);for(var g,m=null;l.height()<a&&h.length;){var v=h.indexOf(" ",f);g=-1!=v?h.substring(0,h.indexOf(" ",f)):h,m=document.createTextNode(g),n.append(m),h=h.length>f&&-1!=v?h.substring(v):""}if(l.height()>=a&&null!=m&&(n[0].removeChild(m),h=m.nodeValue+h),!h.length)return!1;c[0].nodeValue=h}return i.contents().length?i.prepend(c):i.append(c),3==c[0].nodeType}}function l(e,t,n,a){if(!e.contents(":last").find(o("columnbreak",!0)).length&&!e.contents(":last").hasClass(o("columnbreak"))&&t.contents().length){var r=t.contents(":first");if(1!=r.get(0).nodeType)return;var d=r.clone(!0);r.hasClass(o("columnbreak"))?(e.append(d),r.remove()):u?(e.append(d),r.remove()):1!=d.get(0).nodeType||d.hasClass(o("dontend"))||(e.append(d),d.is("img")&&n.height()<a+20?r.remove():!r.hasClass(o("dontsplit"))&&n.height()<a+20?r.remove():d.is("img")||r.hasClass(o("dontsplit"))?d.remove():(d.empty(),i(d,r,n,a)?r.addClass(o("split")):(r.addClass(o("split")),r.children().length&&l(d,r,n,a)),0==d.get(0).childNodes.length&&d.remove()))}}function a(){if(!s.data("columnized")||1!=s.children().length){if(s.data("columnized",!0),s.data("columnizing",!0),s.empty(),s.append(e("<div class='"+o("first")+" "+o("last")+" "+o("column")+" ' style='width:100%; float: "+t.columnFloat+";'></div>")),$col=s.children().eq(s.children().length-1),$destroyable=h.clone(!0),t.overflow){for(targetHeight=t.overflow.height,i($col,$destroyable,$col,targetHeight),$destroyable.contents().find(":first-child").hasClass(o("dontend"))||l($col,$destroyable,$col,targetHeight);$col.contents(":last").length&&r($col.contents(":last").get(0));){var n=$col.contents(":last");n.remove(),$destroyable.prepend(n)}for(var a="",d=document.createElement("DIV");$destroyable[0].childNodes.length>0;){var c=$destroyable[0].childNodes[0];if(c.attributes)for(var f=0;f<c.attributes.length;f++)0==c.attributes[f].nodeName.indexOf("jQuery")&&c.removeAttribute(c.attributes[f].nodeName);d.innerHTML="",d.appendChild($destroyable[0].childNodes[0]),a+=d.innerHTML}e(t.overflow.id)[0].innerHTML=a}else $col.append($destroyable);s.data("columnizing",!1),t.overflow&&t.overflow.doneFunc&&t.overflow.doneFunc()}}function r(t){return 3==t.nodeType?!!/^\s+$/.test(t.nodeValue)&&(!!t.previousSibling&&r(t.previousSibling)):1==t.nodeType&&(!!e(t).hasClass(o("dontend"))||0!=t.childNodes.length&&r(t.childNodes[t.childNodes.length-1]))}function d(){if(m=0,f!=s.width()){f=s.width();var n=Math.round(s.width()/t.width),d=t.width,g=t.height;if(t.columns&&(n=t.columns),u&&(n=h.find(o("columnbreak",!0)).length+1,d=!1),n<=1)return a();if(!s.data("columnizing")){s.data("columnized",!0),s.data("columnizing",!0),s.empty(),s.append(e("<div style='width:"+Math.floor(100/n)+"%; float: "+t.columnFloat+";'></div>")),(C=s.children(":last")).append(h.clone()),c=C.height(),s.empty();var v=c/n,p=3,b=!1;t.overflow?(p=1,v=t.overflow.height):g&&d&&(p=1,v=g,b=!0);for(var w=0;w<p&&p<20;w++){s.empty();var y;try{y=h.clone(!0)}catch(e){y=h.clone()}y.css("visibility","hidden");for(M=0;M<n;M++){N=0==M?o("first"):"";N+=" "+o("column");var N=M==n-1?o("last")+" "+N:N;s.append(e("<div class='"+N+"' style='width:"+Math.floor(100/n)+"%; float: "+t.columnFloat+";'></div>"))}for(M=0;M<n-(t.overflow?0:1)||b&&y.contents().length;){s.children().length<=M&&s.append(e("<div class='"+N+"' style='width:"+Math.floor(100/n)+"%; float: "+t.columnFloat+";'></div>"));var C=s.children().eq(M);for(i(C,y,C,v),l(C,y,C,v);C.contents(":last").length&&r(C.contents(":last").get(0));){var $=C.contents(":last");$.remove(),y.prepend($)}M++,0==C.contents().length&&y.contents().length?C.append(y.contents(":first")):M!=n-(t.overflow?0:1)||t.overflow||y.find(o("columnbreak",!0)).length&&n++}if(t.overflow&&!b){if(document.all&&-1!=navigator.appVersion.indexOf("MSIE 7.")){for(var T="",x=document.createElement("DIV");y[0].childNodes.length>0;){for(var L=y[0].childNodes[0],M=0;M<L.attributes.length;M++)0==L.attributes[M].nodeName.indexOf("jQuery")&&L.removeAttribute(L.attributes[M].nodeName);x.innerHTML="",x.appendChild(y[0].childNodes[0]),T+=x.innerHTML}e(t.overflow.id)[0].innerHTML=T}else e(t.overflow.id).empty().append(y.contents().clone(!0))}else if(b)s.children().each(function(e){(C=s.children().eq(e)).width(d+"px"),0==e?C.addClass(o("first")):e==s.children().length-1?C.addClass(o("last")):(C.removeClass(o("first")),C.removeClass(o("last")))}),s.width(s.children().length*d+"px");else{for(C=s.children().eq(s.children().length-1);y.contents().length;)C.append(y.contents(":first"));C.height();var z=0,k=1e7,F=0,H=!1,O=0;s.children().each(function(e){return function(t){var n=e.children().eq(t);if(!n.children(":last").find(o("columnbreak",!0)).length){var i=n.height();H=!1,z+=i,i>F&&(F=i,H=!0),i<k&&(k=i),O++}}}(s));var I=z/O;0==z?w=p:t.lastNeverTallest&&H?(m+=30,v+=30,w==p-1&&p++):F-k>30?v=I+30:Math.abs(I-v)>20?v=I:w=p}s.append(e("<br style='clear:both;'>"))}s.find(o("column",!0)).find(":first"+o("removeiffirst",!0)).remove(),s.find(o("column",!0)).find(":last"+o("removeiflast",!0)).remove(),s.data("columnizing",!1),t.overflow&&t.overflow.doneFunc(),t.doneFunc()}}}var s=e(t.target?t.target:this),c=e(this).height(),h=e("<div></div>"),f=0,u=t.manualBreaks,g=n.cssClassPrefix;"string"==typeof t.cssClassPrefix&&(g=t.cssClassPrefix);var m=0;if(h.append(e(this).contents().clone(!0)),!t.ignoreImageLoading&&!t.target&&!s.data("imageLoaded")&&(s.data("imageLoaded",!0),e(this).find("img").length>0)){var v=function(e,n){return function(){e.data("firstImageLoaded")||(e.data("firstImageLoaded","true"),e.empty().append(n.children().clone(!0)),e.columnize(t))}}(e(this),h);return e(this).find("img").one("load",v),void e(this).find("img").one("abort",v)}s.empty(),d(),t.buildOnce||e(window).resize(function(){!t.buildOnce&&e.browser.msie?(s.data("timeout")&&clearTimeout(s.data("timeout")),s.data("timeout",setTimeout(d,200))):t.buildOnce||d()})})}}(jQuery);